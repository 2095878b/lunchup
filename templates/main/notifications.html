{% extends 'base.html' %}

{% load staticfiles %}

{% block title %}Notifications{% endblock %}

{% block body_block %}

      <div class="row row-offcanvas row-offcanvas-right">

        <div class="col-xs-12 col-sm-9">
          <p class="pull-right visible-xs">
            <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
          </p>
          <div class="jumbotron_two">
            <h1><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> <span class="font_styled">Notifications</span></h1>
            <p style="font-size:16px;" class="font_styled">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See who you've been matched up with, view their profiles and arrange to lunch up!</p>
          </div>
          <div class="row" style="padding:15px;">
          {% if notifications %}
            {% for notif in notifications %}
                {% if notif.userOne == userprofile %}
                  <div class="col-md-12" style="border: 2px solid; border-radius: 25px; border-color: #dedede; margin-bottom:15px; padding:10px; background-color:#ffffff;">
                    <div class="col-md-1" style="margin:9px 30px 0 0;"><img src="../../static/images/profile_pics/16_f.jpg" width="90" class="img-circle" /></div>
                    <div class="col-md-9">
                      <span style="font-size:26px; font-weight:bold;" class="font_styled">&nbsp;&nbsp;&nbsp;&nbsp;{{ notif.userTwo.fullName }}</span><br />
                      <ul><li>Available:
                          {% for timeint in notif.available.all %}
                            {{ timeint.time }}:00-{{ timeint.time|add:1 }}:00 on {{ timeint.day }}s&nbsp;&nbsp;
                          {% endfor %}
                      </li><li>Interests: {{ notif.userTwo.interests }}</li></ul>
                    </div>
                    <div class="col-md-1" style="margin:9px 30px 0 0;">
                      <a href="/profile/{{ notif.userTwo.user.id }}"><button type="button" class="btn btn-warning">View <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></button></a>
                      <button id="{{ notif.id }}y" type="button" class="btn btn-success"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button>
                      <button id="{{ notif.id }}n" type="button" class="btn btn-danger"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                    </div>
                  </div>
                {% else %}
                  <div class="col-md-12" style="border: 2px solid; border-radius: 25px; border-color: #dedede; margin-bottom:15px; padding:10px; background-color:#ffffff;">
                    <div class="col-md-1" style="margin:9px 30px 0 0;"><img src="../../static/images/profile_pics/16_f.jpg" width="90" class="img-circle" /></div>
                    <div class="col-md-9">
                      <span style="font-size:26px; font-weight:bold;" class="font_styled">&nbsp;&nbsp;&nbsp;&nbsp;{{ notif.userOne.fullName }}</span><br />
                      <ul><li>Available:
                          {% for timeint in notif.available.all %}
                            {{ timeint.time }}:00-{{ timeint.time|add:1 }}:00 on {{ timeint.day }}s&nbsp;&nbsp;
                          {% endfor %}
                      </li><li>Interests: {{ notif.userOne.interests }}</li></ul>
                    </div>
                    <div class="col-md-1" style="margin:9px 30px 0 0;">
                      <a href="/profile/{{ notif.userOne.user.id }}"><button type="button" class="btn btn-warning">View <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></button></a>
                      <button id="{{ notif.id }}y" type="button" class="btn btn-success"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button>
                      <button id="{{ notif.id }}n" type="button" class="btn btn-danger"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                    </div>
                  </div>
                {% endif %}
            {% endfor %}
          {% else %}
          <h3>No notifications yet.</h3>
          {% endif %}

          </div><!--/row-->
        </div><!--/.col-xs-12.col-sm-9-->

        <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar">
          <h3><span class="glyphicon glyphicon-comment" aria-hidden="true"></span> <span class="font_styled">Feedback</span></h3><span class="font_styled">What people are saying about you.</span><br /><br />
          <div class="list-group">
            <span href="#" class="list-group-item" style="padding:15px;"><img src="../../static/images/profile_pics/10_m.jpg" width="40" class="img-circle" style="float:left; margin-right:10px;" />&ldquo;Lorem ipsum dolor sit amet, vim omnesque delicata in, dicat cotidieque ne sed. Lorem tollit denique usu ei, animal reformidans vim at.&rdquo;<br />&mdash;<a href="#">Harry Starry</a></span>
            <span href="#" class="list-group-item" style="padding:15px;"><img src="../../static/images/profile_pics/17_f.jpg" width="40" class="img-circle" style="float:left; margin-right:10px;" />&ldquo;Lorem ipsum dolor sit amet, vim omnesque delicata in, dicat cotidieque ne sed.&rdquo;<br />&mdash;<a href="#">Lauren Fauren</a></span>
            <span href="#" class="list-group-item" style="padding:15px;"><img src="../../static/images/profile_pics/05_m.jpg" width="40" class="img-circle" style="float:left; margin-right:10px;" />&ldquo;Tollit denique usu ei, animal reformidans vim at.&rdquo;<br />&mdash;<a href="#">Joe Styyr</a></span>
            <span href="#" class="list-group-item" style="padding:15px;"><img src="../../static/images/profile_pics/04_m.jpg" width="40" class="img-circle" style="float:left; margin-right:10px;" />&ldquo;Omnesque delicata in, dicat cotidieque ne sed denique usu ei.&rdquo;<br />&mdash;<a href="#">Dominic Fresde</a></span>
          </div>
        </div><!--/.sidebar-offcanvas-->
      </div><!--/row-->

      <hr>
<script>
$(document).ready(function() {
    $.ajaxSetup({
        data: {csrfmiddlewaretoken: '{{ csrf_token }}'}
    });
    // TODO: Change to on/delegate so new elements can be removed as well
    $(".btn-success, .btn-danger").click(function(){
        var elem = $(this).parent();
        var info = $(this).attr('id');
        var notifid = info.substr(0, info.length - 1);
        var accept = info.substr(info.length - 1, 1);
        $.post('/accept_or_decline/', {"notifid":notifid, "accept":accept}).done(function(data){
            elem.parent().remove();
        });
    });
});
</script>
{% endblock %}